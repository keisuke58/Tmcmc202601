# Sigma（ノイズレベル）推奨値

## 結果の分析

### 各sigma値での最大差分（Max Diff）

| Sigma | M1 Max Diff | M2 Max Diff | M3 Max Diff | 相対誤差（phibar≈0.1として） |
|-------|-------------|-------------|-------------|---------------------------|
| 0.1   | 0.208       | 0.237       | 0.283       | ~200-300%                 |
| 0.05  | 0.104       | 0.119       | 0.141       | ~100-140%                 |
| **0.01** | **0.021**   | **0.024**   | **0.028**   | **~2-3%**                 |
| 0.001 | 0.002       | 0.002       | 0.003       | ~0.2-0.3%                 |
| 0.0001| 0.0002      | 0.0002      | 0.0003      | ~0.02-0.03%               |
| 0.00001| 0.00002   | 0.00002     | 0.00003     | ~0.002-0.003%             |
| 0.0   | 0.000       | 0.000       | 0.000       | 0%                        |

### phibarの値の範囲
- M1: 0.018486 - 0.234355
- M2: 同様の範囲
- M3: 同様の範囲

**平均的なphibar値 ≈ 0.1** として相対誤差を計算

---

## 推奨値（用途別）

### 1. **論文再現・標準設定**: `sigma = 0.01` ✅ **推奨**

**理由**:
- 現在の標準設定
- 相対誤差 ~2-3%（現実的な観測ノイズレベル）
- データ点とモデルのバランスが良い
- 論文の条件と一致

**使用例**:
```python
exp_config.sigma_obs = 0.01
```

**特徴**:
- Max diff: 0.02-0.03
- Mean diff: 0.007-0.008
- データ点が適度にモデルからずれる（現実的）

---

### 2. **精密実験・高精度が必要な場合**: `sigma = 0.001 - 0.005`

**推奨**: `sigma = 0.001` または `sigma = 0.005`

**理由**:
- より小さいノイズで、モデルの精度を厳密に評価
- 相対誤差 ~0.2-0.5%（非常に小さい）
- デバッグやアルゴリズムの検証に適している

**使用例**:
```python
exp_config.sigma_obs = 0.001  # 10倍小さいノイズ
# または
exp_config.sigma_obs = 0.005  # 2倍小さいノイズ
```

**特徴**:
- Max diff: 0.002-0.003（sigma=0.001）
- Mean diff: 0.0007-0.0008
- データ点がほぼモデルに一致（高精度）

---

### 3. **デバッグ・テスト**: `sigma = 0.0001 - 0.001`

**推奨**: `sigma = 0.0001`

**理由**:
- ノイズの影響を最小限に抑えつつ、完全にゼロではない
- 可視化でデータ点と線がほぼ一致
- コードの動作確認に適している

**使用例**:
```python
exp_config.sigma_obs = 0.0001  # 100倍小さいノイズ
```

**特徴**:
- Max diff: 0.0002-0.0003
- Mean diff: 0.00007-0.00008
- データ点がほぼ完全にモデルに一致

---

### 4. **ノイズなし（トレーニングデータ）**: `sigma = 0.0`

**使用例**:
```python
exp_config.no_noise = True
# または
exp_config.sigma_obs = 0.0
```

**特徴**:
- Max diff: 0.0（完全一致）
- データ点と線が完全一致
- トレーニングデータや検証用に使用

---

## 用途別の選択ガイド

### 📊 **論文発表・標準実験**
→ **`sigma = 0.01`** ✅

### 🔬 **精密実験・アルゴリズム検証**
→ **`sigma = 0.001`** または **`sigma = 0.005`**

### 🐛 **デバッグ・コード検証**
→ **`sigma = 0.0001`** または **`sigma = 0.001`**

### 🎯 **トレーニングデータ生成**
→ **`sigma = 0.0`**（`no_noise = True`）

---

## 実際の使用例

### コマンドラインから実行

```bash
# 標準設定（論文再現）
python -m main.case2_main --mode debug --sigma-obs 0.01

# 精密実験
python -m main.case2_main --mode debug --sigma-obs 0.001

# デバッグ用（小さなノイズ）
python -m main.case2_main --mode debug --sigma-obs 0.0001

# ノイズなし
python -m main.case2_main --mode debug --no-noise
```

### Pythonコードから設定

```python
from main.case2_main import ExperimentConfig

exp_config = ExperimentConfig()

# 標準設定
exp_config.sigma_obs = 0.01

# 精密実験
exp_config.sigma_obs = 0.001

# デバッグ用
exp_config.sigma_obs = 0.0001

# ノイズなし
exp_config.no_noise = True
```

---

## 視覚的な比較

生成された図（`_runs/test_sigma_comparison/figures/`）で確認：

1. **`M1_sigma_comparison.png`**, **`M2_sigma_comparison.png`**, **`M3_sigma_comparison.png`**
   - 各sigma値でのデータ点と線の一致度を視覚的に比較

2. **`summary_sigma_comparison.png`**
   - Max/Mean difference vs Sigma の関係をログスケールで表示

3. **各speciesの個別比較図**
   - 各speciesごとの詳細な比較

---

## まとめ

### 🎯 **最も推奨**: `sigma = 0.01`
- 標準設定
- 現実的な観測ノイズレベル
- 論文の条件と一致

### 🔬 **精密実験用**: `sigma = 0.001`
- より小さいノイズ
- アルゴリズムの精度評価に適している

### 🐛 **デバッグ用**: `sigma = 0.0001`
- ノイズの影響を最小限に
- コードの動作確認に適している

### ✅ **結論**
**ほとんどの場合、`sigma = 0.01`が推奨されます。**

より精密な実験が必要な場合のみ、`sigma = 0.001`や`sigma = 0.0001`を検討してください。
