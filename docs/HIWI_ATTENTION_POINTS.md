# Hiwi / 修士論文 技術的・理論的注意点チェックリスト

**目的**: Felix Klempt 氏の研究室（IKM）における「ハミルトン原理に基づくバイオフィルムモデル」研究において、口頭試問・査読・議論で突っ込まれる可能性のある点を整理し、事前に準備しておくためのドキュメント。

---

## 1. 物理的整合性とパラメータの制約

### 1.1 相互作用係数 \(a_{ij}\) の符号と強度の物理的意味

**現状**:
- README に「\(a_{35}\) (Vd→Pg) の事前分布を [0, 30] → [0, 5] に制限したことで Pg RMSE が 76% 改善」と明記
- `data_5species/model_config/prior_bounds.json` に bounds が反映済み
- `FEM/a35_sweep_sensitivity.py` で \(a_{35} \in [0, 25]\) を 51 点 sweep し、Pg・DI・\(c_{\min}\) の応答を評価
- 結果: \(a_{35} > 5\) で Pg 量・DI がサチュレーション → bounds [0, 5] で応答域を十分カバー

**突っ込まれうる点**:
- 「\(a_{35} \in [0, 5]\) が生物学的に妥当」という根拠を Heine et al. (2025) や他文献値とどう結びつけるか？
- 現状の根拠は主にモデル内部の感度解析（サチュレーション）であり、外部文献との照合は弱い

**準備しておくこと**:
- [ ] \(a_{35}, a_{45}\) の事後分布要約と Heine 図4C 等との対応表を 1 枚用意
- [ ] 「このレンジなら観測された Pg サージと整合的」と説明できる根拠をメモ

---

### 1.2 自己抑制率 \(d_i\) の役割

**現状**:
- README では \(d_i\) の役割は ODE 式の説明レベルにとどまる
- 条件間（Static vs HOBIC）で \(d_i\) がどう変わるかの生物学的解釈は明示されていない

**突っ込まれうる点**:
- バイオフィルムの飽和は栄養枯渇だけでなく、物理的スペース限界・老廃物蓄積も関係する
- 推定された \(d_i\) が各条件で大きく異なる場合、「流体せん断力が自己抑制にどう影響しているか」の解釈が求められる

**準備しておくこと**:
- [ ] 各条件の \(d_i\)（特に Pg, bridge species）の MAP / 95% CI を表または小図にまとめる
- [ ] 「HOBIC 下で自己抑制がどう変わるか」を一言で説明できるメモを用意

---

## 2. マルチスケール連成の「時間」の扱い

### 2.1 定常状態 vs 遷移状態

**現状**:
- 0D ODE から種組成を取得し、3D FEM にマッピング
- DI は Shannon エントロピーから計算される**状態量**（ある時点の組成）
- 成長固有ひずみ \(\varepsilon(\mathbf{x})\) は \(\alpha_{\text{Monod}}(\mathbf{x}) = k_\alpha \int_0^T \varphi_{\text{total}} \cdot c/(k+c)\,dt\) という**時間積分量**
- `biofilm_3tooth_report.tex` では \(s_{\mathrm{DI}}\) を「TMCMC MAP, snapshot 20」から取得と記載

**突っ込まれうる点**:
- FEM Stage 2 で用いる DI や \(\varepsilon\) は**どの時点**（例: 48h 時点）のデータか、あるいは時間積分した結果かが曖昧だと指摘されうる
- Klempt (2024) は定常状態の栄養拡散を扱う。本モデルの「成長ひずみ」が「最終厚み」を表すのか「成長速度」を表すのかの整理が必要

**準備しておくこと**:
- [ ] 1 枚の図で時間軸を明確化:
  - ODE: \(t \in [0, 48\text{h}]\) → 最終時刻 \(\varphi_i(T)\) から DI\(_{0D}\) を計算（**状態量**）
  - 1D/2D PDE: \(c(\mathbf{x}, t)\) から \(\alpha_{\text{Monod}}(\mathbf{x})\) を時間積分（**履歴量**）
- [ ] 「**DI は最終組成状態を反映、\(\varepsilon\) は成長履歴を反映**」と一文で説明できるようにする

---

## 3. Dysbiotic Index (DI) のマッピングの妥当性

### 3.1 エントロピーから剛性への変換式

**現状**:
- \(E(\mathrm{DI}) = E_{\max}(1-r)^n + E_{\min} \cdot r\), \(r = \mathrm{clip}(\mathrm{DI}/s, 0, 1)\)
- \(E_{\max}, E_{\min}\) は Klempt 2025, Billings 2015 等の文献ベース
- \(n = 2\), \(s_{\mathrm{DI}} = 0.025778\) は TMCMC MAP と感度解析に基づく
- `FEM/_eeff_sensitivity_runs/` で \(E_{\max}, E_{\min}, n\) の sweep を実施

**突っ込まれうる点**:
- なぜ \(n = 2\) なのか？ \(n = 1\) や \(n = 3\) でもよいのでは？
- \(s = 0.025778\) の根拠は？ マッピング関数自体の不確かさをどう扱うか？

**準備しておくこと**:
- [ ] \(n\) と \(s\) を変えたときの代表的な応力プロファイル（2–3 ケース）の小図を用意
- [ ] 「パラメータを振っても **commensal / dysbiotic の力学的順位づけは不変**」と示せるようにする
- [ ] 口頭説明: 「機構的には単調減少・凸型を仮定し、レンジと曲率は文献値と感度解析でチューニング」というフレームで説明

---

## 4. 1D/2D 拡散モデルによる「均質化」の回避

### 4.1 空間分布の消失問題

**現状**:
- README Limitations に「1D Fick 拡散は種組成を空間的に均質化し、DI の空間変化を消失させる」と明記
- **Hybrid アプローチ**（0D DI × 1D spatial \(\alpha\)）で補完
- 2D 反応拡散（`multiscale_coupling_2d.py`）も PoC として実装済み

**突っ込まれうる点**:
- 「本来は 3D PDE で解くべきでは？」という問いが来る可能性が高い
- 「計算コストとモデルの識別のバランス」として現手法を正当化する準備が必要

**準備しておくこと**:
- [ ] 1D/2D で DI が均質化する図と、0D DI の条件差の図を並べた 1 枚を用意
- [ ] 「**識別情報は 0D に、空間構造は PDE に**」というメッセージを明確に
- [ ] 3D RD を採用しない理由（計算量・同定可能性・実験データの制約）を簡潔に説明できるメモ

---

## 5. TMCMC の収束と多峰性

### 5.1 事後分布の形状

**現状**:
- 20 次元パラメータ空間では事後分布が多峰性を持つ可能性がある
- TMCMC コアは ESS, \(\hat{R}\), β スケジュール等の診断を実装
- README で「ESS 200–300, \(\hat{R} \approx 1\)」を報告
- 事後分布のヒートマップ・交差ヒートマップ図あり

**突っ込まれうる点**:
- 1000 粒子が 1 点に固まっていないか、あるいは全く異なるパラメータセットで同程度の RMSE を出す「解の不透明性」がないか
- 事後分布のペアプロット（Corner Plot）で相関を確認しておくべき

**準備しておくこと**:
- [ ] 代表条件（例: Dysbiotic HOBIC）について、主要パラメータ（\(a_{35}, a_{45}, a_{23}, d_i\)）の **Corner Plot** を 1 枚用意
- [ ] 別シードで 1–2 本再実行し、MAP / CI が安定していることを確認（既に実施済みならその図をすぐ出せるようにする）
- [ ] 口頭説明: 「TMCMC は多峰性に比較的強いが、唯一の真の山を保証するものではない。複数シード・感度解析でロバスト性を確認している」と説明できるようにする

---

## まとめ

| 論点 | 現状の強み | 追加で準備すべきもの |
|------|------------|----------------------|
| 1. \(a_{ij}, d_i\) の物理的妥当性 | a35-sweep, prior bounds の根拠あり | Heine 文献との対応表、\(d_i\) 条件間比較 |
| 2. 時間の扱い | DI=状態量、\(\varepsilon\)=履歴量と設計済み | 時間軸を明示した 1 枚図 |
| 3. DI→E マッピング | 感度 sweep 実施済み | \(n, s\) 変動時の応力プロファイル図 |
| 4. 1D/2D 均質化 | Hybrid アプローチで回避、Limitations に明記 | 3D RD を採用しない理由の簡潔メモ |
| 5. TMCMC 多峰性 | ESS, \(\hat{R}\) 報告済み | Corner Plot、複数シード比較 |

---

## 関連ファイル

| 論点 | 参照ファイル |
|------|--------------|
| 1 | `data_5species/model_config/prior_bounds.json`, `FEM/a35_sweep_sensitivity.py` |
| 2 | `FEM/multiscale_coupling_1d.py`, `FEM/generate_hybrid_macro_csv.py` |
| 3 | `FEM/DI_Eeff_sensitivity.md`, `FEM/_eeff_sensitivity_runs/` |
| 4 | `FEM/multiscale_coupling_1d.py`, `FEM/multiscale_coupling_2d.py` |
| 5 | `data_5species/core/tmcmc.py`, `data_5species/docs/paper_comprehensive_figs/` |

---

*最終更新: 2026-02-24*
